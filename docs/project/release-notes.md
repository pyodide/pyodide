(release-notes)=
# Release Notes
Pyodide 0.17.0 is a major step forward from previous versions. It includes major
maintenance improvements, a thorough redesign of the central APIs, and careful
elimination of error leaks and memory leaks.

## New Features

### Asyncio Support

We added full support for asyncio, including a new Python event loop that
schedules tasks on the browser event loop, support for top level await in
`runPythonAsync`, and support for asyncio in `JsProxy` and `PyProxy`, so that it
is possible to await a Python awaitable from Javascript and a Javascript
thenable from Python. This allows seamless interoperability:
```{pyodide}
pyodide.runPython(`
async def test():
    from js import fetch
    # Fetch the Pyodide packages list
    r = await fetch("packages.json")
    data = await r.json()
      # return all available packages
    return data.dependencies.object_keys()
`);
let test = pyodide.globals.get("test");
// test returns a coroutine, we can await the coroutine
// from Javascript and it will schedule it on the Python event loop
result = await test();
console.log(result); // ["asciitree", "parso", "scikit-learn", ...]
```

### Error Handling

Errors can now be thrown in Python and caught in Javascript or thrown in
Javascript and caught in Python.

Support for this is integrated at the lowest level, so calls between Javascript
and C functions behave as expected. The error conversion code is generated by C
macros which makes implementing and debugging new logic dramatically simpler.

```{pyodide}
function jserror(){
   throw new Error(“ooops!”);
}
pyodide.runPython(`
   from js import jserror
   from pyodide import JsException
   try:
       jserror()
   except JsException as e:
      print(e.args[0]) # prints “TypeError: ooops!”
`);
```

### Python "builtin" Modules implemented in Javascript

It is now simple to add a Python module implemented in Javascript using
{any}`pyodide.registerJsModule`:
```{pyodide}
let my_module = {
    foo(x){
        return x*x + 1;
    },
    bar(y, z){
        return y*z + y + z;
    }
};
pyodide.registerJsModule("my_mod", my_module);
pyodide.runPython(`
from my_mod import foo, bar
foo(7) # 50
bar(9, 5) # 59
`);
```

## API Changes

## Bug fixes

We fixed many of the long standing bugs

## Maintenance
Pyodide version 0.17.0 comes with an enormous amount of maintenance work. There
is still a significant amount of work to do be done before Pyodide will be ready
for a version 1.0, but we made very significant headway. Significant
improvements were made to every component of Pyodide, including the build
system, the test suite and continuous integration, and the core Pyodide code.

### Upstream Emscripten

We finally completed the migration to the latest version of Emscripten
(https://emscripten.org/) compiler toolchain which uses the upstream LLVM
backend. This allows us to take advantage of  recent improvements to the
toolchain reducing package size and execution time.

For instance, the scipy package  shrank dramatically from 92 MB to 15 MB. Scipy
is now automatically cached in browsers, greatly improving the usability of
scientific Python packages that depend on scipy, such as scikit-image and
scikit-learn. The size of the base Pyodide environment with only the CPython
standard library shrank from 8.1 MB to 6.4 MB.

On the performance side, the latest toolchain comes with a 25% to 30% run time
improvement for pure Python code.

Because we are now using a very recent Emscripten version, we were able to
upstream many of our patches to the compiler toolchain.

### Pyodide Core Improvements
We elimint

#### Typed Hiwire
Web assembly variables can only hold numbers, so in order for web assembly to
talk about Javascript objects we maintain a Javascript Map and in Wasm we pass
around indexes into the map. The module that coordinates this is called hiwire.
In version 0.16, these keys were typed as `int`s in the C code. We changed these
to a new type called `JsRef`. This simple change dramatically improved the
readability and mistake-resiliance of the C code.

#### Error Handling
We systematically reworked the error handling system.




## Porting
