From 3826e212f69e9b0274e93d6054286a97a51597e6 Mon Sep 17 00:00:00 2001
From: Hood Chatham <roberthoodchatham@gmail.com>
Date: Sat, 2 Jul 2022 08:04:02 -0700
Subject: [PATCH] Remove 'exception of type' prefix when the exception has a
 message

I think this makes the message a bit more readable.
---
 system/lib/libcxxabi/src/cxa_exception_emscripten.cpp | 4 ++--
 tests/test_core.py                                    | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/system/lib/libcxxabi/src/cxa_exception_emscripten.cpp b/system/lib/libcxxabi/src/cxa_exception_emscripten.cpp
index 4e971db93..3a1bf2a88 100644
--- a/system/lib/libcxxabi/src/cxa_exception_emscripten.cpp
+++ b/system/lib/libcxxabi/src/cxa_exception_emscripten.cpp
@@ -92,8 +92,8 @@ char* __get_exception_message(void* thrown_object, bool terminate=false) {
     const char* what =
       static_cast<const std::exception*>(thrown_object)->what();
     asprintf(&result,
-             (terminate ? "terminating with uncaught exception of type %s: %s"
-                        : "exception of type %s: %s"),
+             (terminate ? "terminating with uncaught exception %s: %s"
+                        : "%s: %s"),
              type_name,
              what);
   } else {
diff --git a/tests/test_core.py b/tests/test_core.py
index 0a4a1c00c..22e80866e 100644
--- a/tests/test_core.py
+++ b/tests/test_core.py
@@ -1685,8 +1685,8 @@ int main(int argc, char **argv)
     expected = '''\
 exception of type int
 exception of type char
-exception of type std::runtime_error: abc
-exception of type myexception: My exception happened
+std::runtime_error: abc
+myexception: My exception happened
 exception of type char const*
 '''
 
-- 
2.25.1

