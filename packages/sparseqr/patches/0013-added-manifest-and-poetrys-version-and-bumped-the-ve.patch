From 5ef6c28bb10023eae9b4705b7882d53cec96de40 Mon Sep 17 00:00:00 2001
From: Yotam Gingold <yotam@yotamgingold.com>
Date: Mon, 9 Aug 2021 05:05:05 -0400
Subject: [PATCH 13/17] added manifest and poetrys version and bumped the
 version

---
 MANIFEST.in              |  1 +
 README.md                | 10 +++++++++-
 pyproject.toml           |  5 ++++-
 setup.py                 |  2 +-
 sparseqr/__init__.py     |  2 +-
 sparseqr/sparseqr_gen.py |  2 ++
 6 files changed, 18 insertions(+), 4 deletions(-)

diff --git a/MANIFEST.in b/MANIFEST.in
index 2e5386a..6a2c14f 100644
--- a/MANIFEST.in
+++ b/MANIFEST.in
@@ -1,3 +1,4 @@
 include test/*.py
 include README.md
 include LICENSE.md
+exclude sparseqr/_sparseqr*
diff --git a/README.md b/README.md
index 1238462..6b7cf65 100644
--- a/README.md
+++ b/README.md
@@ -113,8 +113,16 @@ or leave them in their directory and call it as a module.
 
 # Deploy
 
-    poetry publish --build
+Change the version in:
 
+    sparseqr/__init__.py
+    setup.py 
+    pyproject.toml 
+
+Run:
+
+    poetry build -f sdist
+    poetry publish
 
 # Tested on
 
diff --git a/pyproject.toml b/pyproject.toml
index 9300cc5..e0990cd 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -1,10 +1,13 @@
 [tool.poetry]
 name = "sparseqr"
-version = "1.1.0"
+version = "1.1.1"
 description = "Python wrapper for SuiteSparseQR"
 authors = ["Yotam Gingold <yotam@yotamgingold.com>", "Juha Jeronen <juha.jeronen@tut.fi>"]
 license = "Public Domain CC0"
 
+include ["test/*.py", "README.md", "LICENSE.md"]
+exclude = ["sparseqr/_sparseqr*"]
+
 [tool.poetry.dependencies]
 python = "^3.7"
 numpy = "^1.21"
diff --git a/setup.py b/setup.py
index cb9ecf8..ce48b35 100644
--- a/setup.py
+++ b/setup.py
@@ -24,7 +24,7 @@ if 'CONDA_PREFIX' in os.environ:
 
 setup(
     name = "sparseqr",
-    version = "1.1.0",
+    version = "1.1.1",
     author = "Yotam Gingold <yotam@yotamgingold.com>",
     url = "https://github.com/yig/PySPQR",
 
diff --git a/sparseqr/__init__.py b/sparseqr/__init__.py
index 95eac58..a8b3556 100644
--- a/sparseqr/__init__.py
+++ b/sparseqr/__init__.py
@@ -17,7 +17,7 @@ See the docstrings of the individual functions for details.
 
 from __future__ import absolute_import
 
-__version__ = '1.0.0'
+__version__ = '1.1.1'
 
 # import the important things into the package's top-level namespace.
 from .sparseqr import qr, rz, solve, permutation_vector_to_matrix
diff --git a/sparseqr/sparseqr_gen.py b/sparseqr/sparseqr_gen.py
index bd69812..45a0029 100644
--- a/sparseqr/sparseqr_gen.py
+++ b/sparseqr/sparseqr_gen.py
@@ -367,6 +367,8 @@ cholmod_sparse *SuiteSparseQR_C_backslash_sparse   /* returns X, or NULL */
 """)
 
 def main():
+    ## Two dirnames because ffibuilder.set_source()
+    ## passes the module name: "sparseqr._sparseqr"
     ffibuilder.compile( verbose = True, tmpdir = os.path.dirname(os.path.dirname(os.path.abspath(__file__))) )
 
 if __name__ == "__main__":
-- 
2.25.1

