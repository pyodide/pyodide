package:
  name: ppl
  version: 1.2
  tag:
    - library
source:
  url: https://www.bugseng.com/products/ppl/download/ftp/releases/1.2/ppl-1.2.tar.xz
  sha256: 691f0d5a4fb0e206f4e132fc9132c71d6e33cdda168470d40ac3cf62340e9a60
  patches:
    - patches/clang5-support.patch
requirements:
  host:
    - libgmp
    - glpk

build:
  type: static_library
  script: |
    emconfigure ./configure \
        CFLAGS="-fPIC" CXXFLAGS="-std=c++11 -fPIC" \
        --disable-dependency-tracking \
        --enable-coefficients=mpz --disable-fpmath \
        --enable-interfaces=c,c++ \
        --disable-shared \
        --with-gmp="${WASM_LIBRARY_DIR}" \
        --with-glpk="${WASM_LIBRARY_DIR}" \
        --prefix=${WASM_LIBRARY_DIR}
    emmake make -j ${PYODIDE_JOBS:-3}
    emmake make  -j ${PYODIDE_JOBS:-3} check
    emmake make install
