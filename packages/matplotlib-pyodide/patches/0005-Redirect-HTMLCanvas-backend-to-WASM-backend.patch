From 1d26fc0dd8ca6eaf2f740771c9ec767a553f047e Mon Sep 17 00:00:00 2001
From: Agriya Khetarpal <74401230+agriyakhetarpal@users.noreply.github.com>
Date: Mon, 16 Dec 2024 17:37:56 +0530
Subject: [PATCH 5/5] Redirect HTMLCanvas backend to WASM backend

---
 matplotlib_pyodide/html5_canvas_backend.py | 12 ++++++++++--
 1 file changed, 10 insertions(+), 2 deletions(-)

diff --git a/matplotlib_pyodide/html5_canvas_backend.py b/matplotlib_pyodide/html5_canvas_backend.py
index 37825b7..91b723f 100644
--- a/matplotlib_pyodide/html5_canvas_backend.py
+++ b/matplotlib_pyodide/html5_canvas_backend.py
@@ -44,7 +44,9 @@ from matplotlib.transforms import Affine2D
 from PIL import Image
 from PIL.PngImagePlugin import PngInfo
 
+# Redirect to the WASM backend
 from matplotlib_pyodide.browser_backend import FigureCanvasWasm, NavigationToolbar2Wasm
+from matplotlib_pyodide.wasm_backend import FigureCanvasAggWasm, FigureManagerAggWasm
 
 try:
     from js import FontFace, ImageData, document
@@ -52,6 +54,7 @@ except ImportError as err:
     raise ImportError(
         "html5_canvas_backend is only supported in the browser in the main thread"
     ) from err
+
 from pyodide.ffi import create_proxy
 
 _capstyle_d = {"projecting": "square", "butt": "butt", "round": "round"}
@@ -599,8 +602,13 @@ class FigureManagerHTMLCanvas(FigureManagerBase):
 
 @_Backend.export
 class _BackendHTMLCanvas(_Backend):
-    FigureCanvas = FigureCanvasHTMLCanvas
-    FigureManager = FigureManagerHTMLCanvas
+    # FigureCanvas = FigureCanvasHTMLCanvas
+    # FigureManager = FigureManagerHTMLCanvas
+    # Note: with release 0.2.3, we've redirected the HTMLCanvas backend to use the WASM backend
+    # for now, as the changes to the HTMLCanvas backend are not yet fully functional.
+    # This will be updated in a future release.
+    FigureCanvas = FigureCanvasAggWasm
+    FigureManager = FigureManagerAggWasm
 
     @staticmethod
     def show(*args, **kwargs):
-- 
2.39.5 (Apple Git-154)

