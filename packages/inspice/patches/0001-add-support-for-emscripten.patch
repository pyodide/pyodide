From ee9c644de4349216e138342bc12c22ad2750f884 Mon Sep 17 00:00:00 2001
From: Pepijn de Vos <pepijndevos@gmail.com>
Date: Tue, 6 May 2025 16:12:38 +0200
Subject: [PATCH 1/2] add support for emscripten

---
 InSpice/Config/ConfigInstall.py | 9 +++++++++
 InSpice/Spice/NgSpice/Shared.py | 2 +-
 2 files changed, 10 insertions(+), 1 deletion(-)

diff --git a/InSpice/Config/ConfigInstall.py b/InSpice/Config/ConfigInstall.py
index bbb6978..7b035c0 100644
--- a/InSpice/Config/ConfigInstall.py
+++ b/InSpice/Config/ConfigInstall.py
@@ -21,6 +21,11 @@ class OsFactory:
             self._name = 'windows'
         elif sys.platform.startswith('darwin'):
             self._name = 'osx'
+        elif sys.platform == 'emscripten':
+            self._name = 'web'
+        else:
+            raise NotImplementedError("Platform not supported")
+
 
     ##############################################
 
@@ -40,6 +45,10 @@ class OsFactory:
     def on_osx(self):
         return self._name == 'osx'
 
+    @property
+    def on_web(self):
+        return self._name == 'web'
+
 OS = OsFactory()
 
 ####################################################################################################
diff --git a/InSpice/Spice/NgSpice/Shared.py b/InSpice/Spice/NgSpice/Shared.py
index 332ba4e..42e2236 100644
--- a/InSpice/Spice/NgSpice/Shared.py
+++ b/InSpice/Spice/NgSpice/Shared.py
@@ -436,7 +436,7 @@ class NgSpiceShared:
 
             elif ConfigInstall.OS.on_osx:
                 path = 'libngspice{}.dylib'
-            elif ConfigInstall.OS.on_linux:
+            elif ConfigInstall.OS.on_linux or ConfigInstall.OS.on_web:
                 path = 'libngspice{}.so'
             else:
                 raise NotImplementedError
-- 
2.49.0

