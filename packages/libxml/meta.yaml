package:
  name: libxml
  version: 2.9.10

source:
  sha256: aafee193ffb8fe0c82d4afef6ef91972cbaf5feea100edc2f262750611b4be1f
  url: http://xmlsoft.org/sources/libxml2-2.9.10.tar.gz

requirements:
  run:
    - zlib
    - libiconv

build:
  library: true
  script: |
    emconfigure ./configure \
        CFLAGS="-fPIC" \
        --disable-dependency-tracking \
        --disable-shared \
        --without-python \
        --with-iconv="${WASM_LIBRARY_DIR}/libiconv" \
        --with-zlib="${WASM_LIBRARY_DIR}/zlib" \
        --prefix=${WASM_LIBRARY_DIR}/libxml
    emmake make -j ${PYODIDE_JOBS:-3}
    emmake make install
    mkdir -p ${WASM_PKG_CONFIG_PATH} && cp ${WASM_LIBRARY_DIR}/libxml/lib/pkgconfig/*.pc ${WASM_PKG_CONFIG_PATH}
