package:
  name: lzma
  version: 1.0.0 # Nonsense
  tag:
    - always
  top-level:
    - lzma
    - _lzma
source:
  sha256: 065040198fde6fd7229b8c0538fc8b848824e35930e3904f46c9e90e9f0f1a3f
  url: https://github.com/python/cpython/archive/refs/tags/v$(PYVERSION).tar.gz
build:
  type: cpython_module
  script: |
    emcc $STDLIB_MODULE_CFLAGS -c Modules/_lzmamodule.c -o Modules/_lzmamodule.o \
      $(pkg-config --cflags --dont-define-prefix liblzma)

    emcc Modules/_lzmamodule.o -o $DISTDIR/_lzma.so $SIDE_MODULE_LDFLAGS \
      $(pkg-config --libs --dont-define-prefix liblzma)

    cp Lib/lzma.py $DISTDIR

requirements:
  host:
    - liblzma
