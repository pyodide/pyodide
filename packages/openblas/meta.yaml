package:
  name: openblas
  version: 0.3.21

source:
  sha256: f36ba3d7a60e7c8bcc54cd9aaa9b1223dd42eaf02c811791c37e8ca707c241ca
  url: https://github.com/xianyi/OpenBLAS/releases/download/v0.3.21/OpenBLAS-0.3.21.tar.gz
  patches:
    - patches/0001-Add-Wno-implicit-function-declaration-flag.patch

build:
  type: shared_library
  script: |
    pwd
    which emcc
    which gcc
    make -d CC=emcc HOSTCC=gcc TARGET=RISCV64_GENERIC NOFORTRAN=1 USE_THREAD=0
    # mkdir -p dist
    # emcc blas_WA.a lapack_WA.a F2CLIBS/libf2c.a ${SIDE_MODULE_LDFLAGS} -o dist/clapack_all.so
    # mkdir -p ${WASM_LIBRARY_DIR}/{lib,include}
    # TODO what to do here
    # cp -r INCLUDE/* ${WASM_LIBRARY_DIR}/include
    # cp dist/clapack_all.so ${WASM_LIBRARY_DIR}/lib
