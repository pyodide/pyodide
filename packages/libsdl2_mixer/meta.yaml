package:
  name: libsdl2_mixer
  version: 2.8.0

source:
  url: https://github.com/libsdl-org/SDL_mixer/releases/download/release-2.8.0/SDL2_mixer-2.8.0.tar.gz
  sha256: 1cfb34c87b26dbdbc7afd68c4f545c0116ab5f90bbfecc5aebe2a9cb4bb31549

build:
  type: static_library
  script: |
    mkdir build && cd build && emcmake cmake \
      -DCMAKE_C_FLAGS="-fPIC" \
      -DCMAKE_INSTALL_PREFIX=${WASM_LIBRARY_DIR} \
      -DBUILD_SHARED_LIBS=OFF \
      -DSDL2MIXER_OPUS=OFF \
      -DSDL2MIXER_MOD=OFF \
      -DSDL2MIXER_MIDI_FLUIDSYNTH=OFF \
      -DSDL2MIXER_WAVPACK=OFF \
      ../

    emmake make -j ${PYODIDE_JOBS:-3}
    emmake make install